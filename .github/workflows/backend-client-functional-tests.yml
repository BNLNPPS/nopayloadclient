on: [push]
jobs:
    Raw-Data-Pipeline-CI:
        runs-on: ubuntu-18.04
        steps:
            - name: Print job info
              run: echo "This job was automatically triggered by a ${{ github.event_name }} event. It is now running on a ${{ runner.os }} server hosted by GitHub! The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
              
            - name: Setup python
              uses: actions/setup-python@v4
              with:
                python-version: '3.7.15'

            - name: Setup SSH Keys and known_hosts
              env:
                  SSH_AUTH_SOCK: /tmp/ssh_agent.sock
              run: |
                  mkdir -p ~/.ssh
                  ssh-keyscan github.com >> ~/.ssh/known_hosts
                  ssh-agent -a $SSH_AUTH_SOCK > /dev/null
                  ssh-add - <<< "${{ secrets.DEPLOY_KEY }}"

            - name: Check out the commit that triggered this job
              uses: actions/checkout@v3
              with:
                path: ${{ github.event.repository.name }}

            - name: Check out nopayloaddb
              env:
                  SSH_AUTH_SOCK: /tmp/ssh_agent.sock
              run: git clone git@github.com:BNLNPPS/nopayloaddb.git